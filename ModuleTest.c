// ModuleTest.c
// Runs on TM4C123
// Min He
// April 19, 2022

// ******* Required Hardware I/O connections*******************
// Slide/rotary pot pin 1 connected to ground
// Slide/rotary pot pin 2 connected to Ain8 (PE5)
// Slide/rotary pot pin 3 connected to pne side of the 1k resistor
// other side of the 1k resistor is connected to +3.3V

// jon added a comment

#include "ADC1SS3.h"
#include "PLL.h"
#include <stdint.h>
#include "Nokia5110.h"
#include <stdio.h>

// #define ADC_TEST
#define LCD_TEST
// #define SOUND_TEST
const uint8_t SmallEnemy30PointA[] = {
		0x42, 0x4D, 0xC6, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x76, 0x00, 0x00, 0x00, 0x28, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x0A, 0x00, 0x00, 0x00, 0x01, 0x00, 0x04, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x80,
		0x00, 0x00, 0x00, 0x80, 0x80, 0x00, 0x80, 0x00, 0x00, 0x00, 0x80, 0x00, 0x80, 0x00, 0x80, 0x80, 0x00, 0x00, 0x80, 0x80, 0x80, 0x00, 0xC0, 0xC0, 0xC0, 0x00, 0x00, 0x00, 0xFF, 0x00, 0x00, 0xFF,
		0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0xFF, 0x00, 0x00, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x0F, 0x00, 0x00, 0xF0, 0x00, 0x00, 0x00, 0x00, 0xF0, 0x00, 0x00, 0x0F, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x0F, 0xF0, 0xF0, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00,
		0xFF, 0x0F, 0xF0, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x0F, 0xFF, 0xFF, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0F, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF};

#define MAX_X_AXIS 83 // size of the LCD screen 48x84, X axis range: 0 to 83

void LCD_Test(void);
void Delay100ms(uint32_t count);
void Delay(uint32_t ulCount);

uint16_t count = 0;
uint16_t score = 2;
int main(void)
{
#ifdef ADC_TEST
	uint8_t x_axis;
#endif
	PLL_Init(); // set system clock to 80 MHz
#ifdef ADC_TEST
	ADC2SS3_Init();
#endif
#ifdef LCD_TEST
	Nokia5110_Init();
#endif

	while (1)
	{
		// uint16_t adcval = ADC1_SS3_In();
#ifdef ADC_TEST
		x_axis = ADCValue_To_X_AXIS(ADC1_SS3_In(), MAX_X_AXIS);
#endif
#ifdef LCD_TEST
		LCD_Test();
#endif
		Delay100ms(10);
	}
}
void Delay100ms(uint32_t count)
{
	uint32_t time;
	while (count > 0)
	{
		time = 72724; // 0.1sec at 16 MHz
		while (time)
		{
			time--;
		}
		count--;
	}
}
#ifdef LCD_TEST
void LCD_Test(void)
{
	const uint8_t prompt[] = "            Game Over   Nice Try!   Your Score ";

	char out[100];
	count = 0;
	Nokia5110_Clear();
	sprintf(out, "%s %d ", prompt, score);
	Nokia5110_PrintBMP(8, 36, SmallEnemy30PointA, 0); // update screen[]
	Nokia5110_DisplayBuffer();												// draw buffer: take pixel information from screen[] snf update the LCD display
	Nokia5110_OutString((char *)prompt);
}
#endif

void Delay(uint32_t ulCount)
{
	do
	{
		ulCount--;
	} while (ulCount);
}
